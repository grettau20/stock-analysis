# VBA_Challenge Module 2

## Overview of Project

####### 
   The purpose of the project is to edit or refactor the AllStocksAnalysis module code for Steve in order to improve the run times. Steve would like to be able to make the code run more efficiently and potentially apply to larger stocks analysis. To edit or refactor the module code, we created an index and output arrays and used for loops to go over the data.

## Results

###  Run Times Performance comparison for 2017 and 2018 before refactoring

#### 2017 Stocks Analysis

![<img width="1440" alt="Screen Shot 2022-09-22 at 9 18 27 AM" src="https://user-images.githubusercontent.com/8636886/191884778-91788c86-04d7-453a-9821-2abc2794bfc1.png">]

#### 2018 Stocks Analysis

![<img width="1440" alt="Screen Shot 2022-09-22 at 9 17 43 AM" src="https://user-images.githubusercontent.com/8636886/191884890-b2112efe-8fb4-42e5-9bf6-7cdd486cdcdf.png">]


###  Run Times Performance Comparison for 2017 and 2018 after refactoring

#### 2017 Stock Analysis Refactored

![<img width="1440" alt="Screen Shot 2022-09-22 at 9 27 45 AM" src="https://user-images.githubusercontent.com/8636886/191884969-03aa1318-aa9f-4658-bcc2-1cb01b6e64fb.png">]


#### 2018 Stock Analysis Refactored


![<img width="1440" alt="Screen Shot 2022-09-22 at 9 28 07 AM" src="https://user-images.githubusercontent.com/8636886/191885040-25a6665f-d025-4a46-8918-ca786ea47ac1.png">]


## Summary

In general, refactoring is very beneficial because it can help improve the view and script run times of the code. It also allows the code to be applied to larger datasets by extending indexes and arrays. Disadvantages include the potential for many errors. All of which require debugging which can be time consuming and defeat the purpose intended in refactoring.

For the stocks analysis specifically, refactoring the module code improved the script run times as seen in the screenshots above by focusing the loops on to defined index and arrays and removing some of the repeated lines like going in and out of different sheets for each loop for example. It also eliminated the nested loop which simplified the code. Disadvantages includes errors such as mismatch errors, overflow errors and expected array errors while creating index and output arrays and trying to integrate them into the code formulas. This specific part took a great deal of time and the assistance of many.





        
